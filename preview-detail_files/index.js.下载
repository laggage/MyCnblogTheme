(()=>{"use strict";function t(t,e){for(var o,n=0;n<e.length;n++)(o=e[n]).enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}function e(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}function o(t,e){for(var o,n=0;n<e.length;n++)(o=e[n]).enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}function n(){var t=function(){var t;return new Date(null===(t=document.querySelector("#post-date"))||void 0===t?void 0:t.textContent)}(),e=function(){var t;return+(null===(t=document.querySelector(".postDesc #post_view_count"))||void 0===t?void 0:t.textContent)}(),o=function(){var t;return+(null===(t=document.querySelector(".postDesc #post_comment_count"))||void 0===t?void 0:t.textContent)}();if(NaN===t.getDate()||NaN===e||NaN===o)setTimeout(n,1e3);else{var a=document.createElement("div");a.classList.add("postInfo"),t=t.getFullYear()+"-"+t.getMonth()+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes(),a.innerHTML='<span class="postInfo-item"><svg class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2738" width="16" height="16"><path fill="#8a8a8a" d="M512 0C228.92 0 0 228.92 0 512c0 282.358 228.92 512 512 512s512-228.92 512-512S794.358 0 512 0m174.037 706.257l-18.054 18.053c-10.11 10.11-25.997 10.11-36.107 0L465.783 558.217c-5.777-5.777-5.055-17.331-5.055-28.886V204.367c0-14.443 11.554-25.275 25.275-25.275h25.275c14.443 0 25.275 11.554 25.275 25.275v317.02L686.037 670.15c10.11 10.11 10.11 25.997 0 36.107m0 0z" p-id="2739"></path></svg><span class="text-muted"> '+t+"</span></span>",a.innerHTML+='<span class="postInfo-item"><svg t="1592845358639" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4518" width="16" height="16"><path d="M727.744 606.976c124.288 78.976 210.688 217.664 222.464 378.496-43.52 5.888-120.896 12.288-231.296 12.288H263.168c-110.4 0-187.712-6.4-231.168-12.288 11.84-160.704 98.304-299.52 222.4-378.496 65.6 51.584 147.008 83.712 236.736 83.712 89.728 0 171.2-32 236.608-83.712zM491.136 0a307.392 307.392 0 0 1 307.072 307.008 307.456 307.456 0 0 1-307.072 306.944 307.328 307.328 0 0 1-307.008-306.944A307.392 307.392 0 0 1 491.136 0z" fill="#8a8a8a" p-id="4519"></path></svg><span class="text-muted"> laggage</span></span><span class="postInfo-item"><svg t="1592845607250" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8509" width="16" height="16"><path d="M512 159.904A550.4 550.4 0 0 0 0 508.992a550.016 550.016 0 0 0 1024 0A550.4 550.4 0 0 0 512 159.904z m0 581.824a232.736 232.736 0 1 1 232.736-232.736A232.8 232.8 0 0 1 512 741.824z m0-372.352a139.648 139.648 0 1 0 139.648 139.648A139.744 139.744 0 0 0 512 369.44z" fill="#8a8a8a" p-id="8510"></path></svg><span class="text-muted"> '+e+'</span></span><span class="postInfo-item"><svg t="1592845935911" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10051" width="16" height="16"><path d="M512 64C229.2 64 0 250.2 0 480c0 99.2 42.8 190 114 261.4C89 842.2 5.4 932 4.4 933c-4.4 4.6-5.6 11.4-3 17.4S9.6 960 16 960c132.6 0 232-63.6 281.2-102.8 65.4 24.6 138 38.8 214.8 38.8 282.8 0 512-186.2 512-416S794.8 64 512 64z" p-id="10052" fill="#8a8a8a"></path></svg><span class="text-muted"> '+o+"</span></span>";var i=document.querySelector(".postTitle").parentElement,s=document.querySelector(".postBody");i.insertBefore(a,s)}}function a(){var t=function(){var t,e=null===(t=document.getElementById("sidebar_postcategory"))||void 0===t?void 0:t.getElementsByTagName("ul");if(null==e)return null;for(var o,n,a,i=(e=e[0]).children,s=[],l=0;l<i.length;l++)n=(o=i[l].querySelector("a")).innerText,a=o.href,s.push({categoryName:n,href:a});return s}(),e=document.getElementById("category-dropdown");if(null==t||null==e)setTimeout(a,1e3);else for(var o,n=0;n<t.length;n++)(o=document.createElement("a")).href=t[n].href,o.innerText=t[n].categoryName,o.classList.add("dropdown-item"),e.appendChild(o)}var i={n:t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},d:(t,e)=>{for(var o in e)i.o(e,o)&&!i.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return e(t,null,[{key:"postBodyEl",get:function(){return $(".postBody")}}]),t}(),l=function(t,e){return document.head.querySelector("#"+t)?Promise.resolve("loaded"):r((function(){var o=document.createElement("script");return o.id=t,o.src=e,o.async=!0,o}))},r=function(t){return new Promise((function(e,o){var n=t();return null===n?void e(""):(n.onload=function(){e("loaded")},n.onerror=function(t){o(t)},void document.head.appendChild(n))}))},c=function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.build=function(){0<$(".postBody").length&&(s.postBodyEl.addClass("markdown-body"),l("hljs","https://files.cnblogs.com/files/Laggage/highlight.min.js").then((function(){hljs.initHighlightingOnLoad()})),l("hljs-line-number","https://blog-static.cnblogs.com/files/Laggage/highlightjs-line-numbers.min.js").then((function(){hljs.initLineNumbersOnLoad()})))}};const u=jQuery;var d=i.n(u),g=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.options={avatarUrl:"https://pic.cnblogs.com/avatar/1596066/20201124214721.png",catalogStartTag:"h2"}}return function(t,e,n){e&&o(t.prototype,e)}(t,[{key:"buildAvatar",value:function(){var t='<span class="avatar"><img alt="avatar" src="'.concat(this.options.avatarUrl,'"/></span>'),e=document.querySelector(this.cnBlogs.blogTitle);null==e?setTimeout(this.buildAvatar,1e3):e.innerHTML=t+e.innerHTML}},{key:"buildSign",value:function(){var t=d()("#blogTitle>h2"),e=d()("#blogTitle>h2").text();t.remove(),d()("#blogTitle>h1").append('<span class="sign">'+e+"</span>")}},{key:"buildBlogPostCategory",value:function(){var t,e=null===(t=document.querySelector("#BlogPostCategory>a"))||void 0===t?void 0:t.textContent,o=document.querySelector(".postInfo");if(null==e||null==e||null==o||null==o)setTimeout(this.buildBlogPostCategory,1e3);else{var n='<span class="postInfo-item icon text-muted">&#xe645;&nbsp;'.concat(e,"</span>");o.innerHTML+=n}}},{key:"getTotalOffsetLeft",value:function(t){for(var e=t,o=0;e;)o+=e.offsetLeft,e=e.offsetParent;return o}},{key:"getTotalOffsetTop",value:function(t){for(var e=t,o=0;e;)o+=e.offsetTop,e=e.offsetParent;return o}},{key:"buildCatalog",value:function(){var t=this;if(this.isPostPage){var e=document.querySelector("#post_detail .postBody");if(null==e||null==e)setTimeout(this.buildCatalog);else{var o=[],n=["h1","h2","h3","h4","h5","h6"],a=n.findIndex((function(e){return e===t.options.catalogStartTag}));n.splice(0,a);var i=e.querySelectorAll(n.join(",")),s=window.location.pathname;i.forEach((function(t){var e=+t.tagName[1]-a-1;o.push('<li><a style="display: inline-block;margin: auto '.concat(e*Number.parseInt(1..toFixed(2)),'rem;" href="').concat(s,"#").concat(t.id,'">').concat(t.textContent.trim(),"</a></li>"))}));var l='<div id="catalog"><h1>本文目录</h1><ul>'.concat(o.join(""),"</ul></div>");document.querySelector("#sideBarMain").innerHTML=l;var r=function(){var e=document.querySelector("#topics");return t.getTotalOffsetLeft(e)+e.clientWidth+20+"px"},c=function(){var e=t.catalog;165<window.pageYOffset&&!e.classList.contains("catalog-fixed")?(e.classList.add("catalog-fixed"),e.style.left=r()):165>=window.pageYOffset&&e.classList.contains("catalog-fixed")&&e.classList.remove("catalog-fixed")},u=function(){var e=t.catalog,o=t.toolBar;768>window.innerWidth?(window.onscroll=function(){},e.classList.add("catalog-fixed"),e.classList.add("catalog-btn-hide"),o.classList.add("catalog-btn-show"),o.classList.remove("catalog-btn-hide")):(e.classList.remove("catalog-btn-hide"),e.classList.add("catalog-btn-show"),e.style.top="",e.style.left=r(),window.onscroll=c,o.classList.add("catalog-btn-hide"),o.classList.remove("catalog-btn-show"))};u(),window.onscroll=c,window.onresize=u}}}},{key:"buildFixedToolBar",value:function(){var t=this,e='<div id="fixed-toolbar"><a class="icon" href="#">&#xe862;</a>'+(this.isPostPage?'<a id="catalogToggleBtn" href="javascript:void(0);" class="icon">&#xe614;</a>':"")+"</div>";document.body.innerHTML+=e,this.isPostPage&&document.querySelector("#catalogToggleBtn").addEventListener("click",(function(){!function(){var e=t.catalog,o=document.querySelector("#catalogToggleBtn");if(e.classList.add("catalog-fixed"),e.classList.contains("catalog-btn-hide")){e.classList.remove("catalog-btn-hide"),e.classList.add("catalog-btn-show");var n=t.getTotalOffsetTop(o),a=t.getTotalOffsetLeft(o);e.style.top=n-e.clientHeight+"px",e.style.left=a-e.clientWidth+o.clientWidth+"px"}else e.classList.add("catalog-btn-hide"),e.classList.remove("catalog-btn-show")}()}))}},{key:"build",value:function(){this.buildAvatar(),this.buildBlogPostCategory(),this.buildFixedToolBar(),this.buildCatalog(),this.buildSign()}},{key:"isPostPage",get:function(){return/Laggage\/p\/\d{1,20}.html$/.test(window.location.pathname)}},{key:"catalog",get:function(){return document.querySelector("#catalog")}},{key:"toolBar",get:function(){return document.querySelector("#catalogToggleBtn")}},{key:"cnBlogs",get:function(){return{header:"#header",blogTitle:"#blogTitle",publicProfile:"#profile_block",navigator:"#navigator",navList:"#navList",sideBar:"#sideBar",sideBarMain:"#sideBarMain",forFlow:".forFlow",postTitle:"#cb_post_title_url",postDetail:"#post_detail",postBody:"#cnblogs_post_body",postDigg:"#div_digg",postCommentBody:".blog_comment_body",feedbackContent:".feedbackItem > .feedbackCon",postSignature:"#MySignature",footer:"#footer"}}}]),t}();!function(){var t=new g;t.build(),(new c).build(),/page=[2-9]{1,100}/.test(window.location.search)&&$("#nav_next_page").hide();try{a()}catch(t){console.info("Custom js encouter an error when run setCategry method"),console.error(t)}try{t.isPostPage&&n()}catch(t){console.info("Custom js encouter an error when run replacePostDate method"),console.error(t)}}()})();